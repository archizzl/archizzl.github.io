<!DOCTYPE html>
<html>
<head>
<style>
  * {
    margin: 0;
    padding: 0;
    user-select: none;
  }
  #container {
    height: 100vh;
    width: 100vw;
    position: absolute;
    background-color: black;
    overflow: hidden;
    z-index: 1;
  }
  .coordinates {
    height: 5px;
    width: 5px;
    position: absolute;
    display: flex;
    justify-content: center;
    align-items: center;
    background-color: white;
    opacity: 1;
    z-index: 10;
  }
  .bar {
    background-color: red;
    position: absolute;
    z-index: 3;
    height: 5px;
    width: 5px;
  }
  #train {
    height: 5px;
    width: 5px;
    position: absolute;
    z-index: 50;
    background-color: gray;
    border: 3px solid white;
    transition: 1s;
  }
</style>
</head>
<body>
  <div id='container'>
  </div>
</body>
<script>
container = document.getElementById('container')
train = document.getElementById('train')
cid = 0;
function create(){
  train = document.createElement('div')
  train.setAttribute('id', 'train')
  container.appendChild(train)
  coords = [];
  for(i = 0; i<50; i++){
    x = Math.random()*100;
    if(x==99){
      x-=1
    }
    y = Math.random()*100;
    if(y==99){
      y-=1
    }
    coords.push(x)
    coords.push(y)
  }
  console.log(coords)
  console.log('array length: ' + coords.length)
  console.log('amount of coordinate pairs: ' + (coords.length)/2)

}

function link(x1, y1, x2, y2){
  end1 = document.createElement('div')
  end1.setAttribute('class', 'coordinates')
  end1.style.left = x1 + 'vw'
  end1.style.top = y1 + 'vh'
  container.appendChild(end1)
  end2 = document.createElement('div')
  end2.setAttribute('class', 'coordinates')
  end2.style.left = x2 + 'vw'
  end2.style.top = y2 + 'vh'
  container.appendChild(end2)
  mid = document.createElement('div')
  mid.setAttribute('class', 'coordinates')
  mid.style.left = x1 + 'vw'
  mid.style.top = y2 + 'vh'
  container.appendChild(mid)

  hbar = document.createElement('div')
  hbar.setAttribute('class', 'bar')
  if(x1>x2){
    hbar.style.left = x2 + 'vw';
    hbar.style.width = x1-x2 + 'vw';
  }
  else {
    hbar.style.left = x1 + 'vw';
    hbar.style.width = x2-x1 + 'vw';
  }
  hbar.style.top = y2 + 'vh'
  hbar.style.opacity = Math.random()*0.5 + 0.5;
  hbar.style.backgroundColor = '#' + Math.floor(Math.random()*16777215).toString(16);
  container.appendChild(hbar)

  vbar = document.createElement('div')
  vbar.setAttribute('class', 'bar')
  if(y1>y2){
    vbar.style.top = y2 + 'vh'
    vbar.style.height = y1 - y2 + 'vh'
  }
  else {
    vbar.style.top = y1 + 'vh'
    vbar.style.height = y2 - y1 + 'vh'
  }
  vbar.style.left = x1 + 'vw'
  vbar.style.opacity = Math.random()*0.5 + 0.5;
  vbar.style.backgroundColor = '#' + Math.floor(Math.random()*16777215).toString(16);
  container.appendChild(vbar)

}

function drawBars(){
  a = 0;
  b = 1;
  c = 2;
  d = 3;
  for(i = 0; i<(coords.length/2)-1; i++){
    link(coords[a], coords[b], coords[c], coords[d])
    console.log(a + '' + b + '' + c + '' + d)
    a+=2
    b+=2
    c+=2
    d+=2
  }
}

function clear(){
  bars = document.querySelectorAll('.bar')
  for(k = 0; k<bars.length; k++){
    bars[k].remove()
  }
  cs = document.querySelectorAll('.coordinates')
  for(j = 0; j<cs.length; j++){
    cs[j].remove()
  }
  train.remove()
  coords = []
  clearInterval(train_interval)
}

function runTrain(){
  train_x = 0;
  train_y = 1;
  train_switch = 0;
  train.style.left = coords[train_x] + 'vw'
  train.style.top = coords[train_y] + 'vh'
  train_interval = setInterval(function(){
    setTimeout(function(){
      if(train_switch%2==0){
        train_y+=2
        train.style.top = coords[train_y] + 'vh'
        train_switch++
      }
      else {
        train_x+=2
        train.style.left = coords[train_x] + 'vw'
        train_switch++
      }
      if(train_x==coords.length-2){
        console.log('done')
        clearInterval(train_interval)
      }
    })
  }, 1000)
}

function run(){
  create()
  drawBars()
  runTrain()
}

document.onclick = function(){
  clear()
  run()
}

run()

</script>
</html>
